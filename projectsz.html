<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="mystyle.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.0/css/all.css' integrity='sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ' crossorigin='anonymous'>
<!-- Bootstrap CSS -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">


    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 80%;
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-md navbar-light bg-light">
    <a class="navbar-brand" href="index.html">
      <img border="0 "src="geossmall.png" height="60px"/>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="research.html">Research</a></li>
        <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
        <li class="nav-item active"><a class="nav-link" href="projectsz.html">Projects</a></li>
      </ul>
    </div>
  </nav>
    <div class="jumbotron">
      <h1>Routes Travelled This Year</h1>
    </div>
    <div id="map"></div>
    <div style="padding-top:30px"></div>
    <div class="dark-header"><h1> Flight Statistics </h1>
      <div id="demo"><button onclick="totalDist()">Calculate</button></div>
    </div>
    <div class="container-fluid">
      <div class="row light">
        <div class="col-sm-6" style="text-align:center">
          <div><h2>Total distance flown this year: <h3 id="routeDist"></h3> </h2></div>

        </div>
        <div class="col-sm-6" style="text-align:center">
          <div><h2>Total time spent in air: <h3 id="demo2"></h3></h2></div>

        </div>
      </div>

  <div class="row dark">
    <div class="col-sm-6" style="text-align:center">
      <div><h2> Times around the Earth </h2><h3 id="moonDist"></h3></div>

    </div>
    <div class="col-sm-6" style="text-align:center">
      <div><h2>Favorite Airport <h3 id="faveAPT"></h3></h2></div>
    </div>
  </div>
  <div class="row light">
    <div class="col-sm-6" style="text-align:center">
      <div><h2> Longest Flight </h2><h3 id="longest"></h3></div>
    </div>
    <div class="col-sm-6" style="text-align:center">
      <div><h2> Shortest Flight <h3 id="shortest"></h3></h2></div>
    </div>
  </div>
  <div class="row dark">
    <div class="col-sm-6" style="text-align:center">
      <div><h2> Favorite Aircraft </h2><h3 id="faveAC"></h3></div>
    </div>
    <div class="col-sm-6" style="text-align:center">
      <div><h2> Favorite Airline </h2><h3 id="a"></h3></div>
    </div>
    <div class=" row top-buffers"></div>
  </div>
<!-- <div class="row light">
  <div style="text-align:center"><h2> Quick Add Flight </h2></div>
  <div class="col-sm-6" style="text-align:center">
      <h4>Origin Latitude: </h4><input type="number" id="entry_lat1" value="Latitude">
      <h4>Origin Longitude: </h4><input type="number" id="entry_long1" value = "Longitude">
      <h4>Destination Latitude: </h4><input type="number" id="entry_lat2" value = "Latitude">
      <h4>Destination Longitude: </h4><input type="number" id="entry_long2" value = "-70.85556">
      <h4>Flight Time (in minutes): </h4><input type="number" id="entry_time" value = "180">
    </div>
    <div class="col-sm-6" style="text-align:center">
      <h4>Depature Airport (Please enter as XXX):</h4><input type="text" id="entry_dep" value="DTW">
      <h4>Arrival Airport (Please enter as XXX):</h4><input type="text" id="entry_arr" value = "PLN">
      <h4>Airline:</h4><input type="text" id="entry_airline" value = "Delta Airlines">
      <h4>Aircraft:</h4><input type="text" id="entry_aircraft" value = "777-200LR">
    </div>
  </div>
  <div class="row dark">
    <div class="col-sm-12" style="text-align:center">
      <div><h2> Add Flight: </h2></div>
      <button onclick="addFlight()">Add Flight</button>
      <div id="test">Is it done?</div>
    </div>
  </div> -->


</div>
    <script>


      // This example creates a 2-pixel-wide red polyline showing the path of
      // the first trans-Pacific flight between Oakland, CA, and Brisbane,
      // Australia which was made by Charles Kingsford Smith.

      function initMap() {
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 5,
          center: {lat: 41.973, lng: -97.142},
          mapTypeId: 'terrain'
        });

        var flightPlanCoordinates = [
          {lat: 33.6407, lng: -84.4277}, // ATL
          {lat: 40.7899, lng: -111.9791}, // SLC
          {lat: 42.2162, lng: -83.3554}, // DTW
          {lat: 47.4502, lng: -122.3088}, // SEA
          {lat: 42.2162, lng: -83.3554}, // DTW
          {lat: 33.6407, lng: -84.4277}, // ATL
          {lat: 42.2162, lng: -83.3554}, // DTW
          {lat: 45.5715, lng: -84.7862}, // PLN
        ];
        var flightPath = new google.maps.Polyline({
          path: flightPlanCoordinates,
          geodesic: true,
          strokeColor: '#FF0000',
          strokeOpacity: 1.0,
          strokeWeight: 2
        });
        var i;
        for (i=0; i<flightPlanCoordinates.length;i++) {
          var marker = new google.maps.Marker({
            position: flightPlanCoordinates[i],
            map: map,
            title: 'Hello World!'
          });
        }


        flightPath.setMap(map);
      }

      // Retrieve info from inputs and make trip object. Then send to trips(). //
//       function addFlight() {
//         var  lat1 = parseFloat(document.getElementById("entry_lat1").value),
//             long1 = parseFloat(document.getElementById("entry_long1").value),
//              lat2 = parseFloat(document.getElementById("entry_lat2").value),
//             long2 = parseFloat(document.getElementById("entry_long2").value),
//              time = parseFloat(document.getElementById("entry_time").value),
//               dep = parseFloat(document.getElementById("entry_dep").value),
//               arr = parseFloat(document.getElementById("entry_arr").value),
//           airline = parseFloat(document.getElementById("entry_airline").value),
//          aircraft = parseFloat(document.getElementById("entry_aircraft").value),
//          new_trip = [lat1,long1,lat2,long2,time,dep,arr,airline,aircraft];
//              document.getElementById("test").innerHTML = "yes";
//              trips(new_trip);
// }

    // Define Trips, and have the ability to add one from the inputs //
    function trips(new_trip) {
      //      Airports    //
            // ATL //
      var lat_ATL = 33.6407,
          long_ATL = -84.4277,

            // DTW //
          lat_DTW = 42.2162,
          long_DTW = -83.3554,

            // PLN //
          lat8 = 45.5715,
          long8 = -84.7862,

            // SEA //
          lat_SEA = 47.4502,
          long_SEA = -122.3088,

            // SLC //
          lat_SLC = 40.7899,
          long_SLC = -111.9791,

          airports = ["ATL","DTW","PLN","SEA","SLC"],
          aircrafts = ["737-900","757-200","A320","A321","CRJ-200","737-800"],
          airlines = ["Delta Airlines","Alaska Airlines","Spirit Airlines"],

          // LEGS //
          // ATL-> SLC //
          time = 4*60 +3,
          numTrips = 1,
          dep = "ATL",
          arr = "SLC",
          aircraft = "737-900",
          airline = "Delta Airlines",
          trip1 = [lat_ATL,long_ATL,lat_SLC,long_SLC,time,dep,arr,airline,aircraft],

          // SLC-> DTW //
          time = 3*60 +29,
          numTrips = 1,
          dep = "SLC",
          arr = "DTW",
          aircraft = "737-900",
          airline = "Delta Airlines",
          trip2 = [lat_SLC,long_SLC,lat_DTW,long_DTW,time,dep,arr,airline,aircraft],

          // DTW -> SEA //
          time = 4*60 +55,
          numTrips = 1,
          dep = "DTW",
          arr = "SEA",
          aircraft = "737-800",
          airline = "Alaska Airlines",
          trip3 = [lat_DTW,long_DTW,lat_SEA,long_SEA,time,dep,arr,airline,aircraft],

          // SEA -> DTW //
          time = 4*60 +55,
          numTrips = 1,
          dep = "SEA",
          arr = "DTW",
          aircraft = "A321",
          airline = "Spirit Airlines",
          trip4 = [lat_DTW,long_DTW,lat_SEA,long_SEA,time,dep,arr,airline,aircraft],

          // DTW -> ATL (JAN 6)//
          time = 2*60 +13,
          numTrips = 1,
          dep = "DTW",
          arr = "ATL",
          aircraft = "A320",
          airline = "Delta Airlines",
          trip5 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft],

          // ATL -> DTW (FEB 21)//
          time = 1*60 +37,
          numTrips = 1,
          dep = "ATL",
          arr = "DTW",
          aircraft = "737-900",
          airline = "Delta Airlines",
          trip6 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft],

          // DTW -> ATL (FEB 24)//
          time = 2*60 +13,
          numTrips = 1,
          dep = "DTW",
          arr = "ATL",
          aircraft = "A320",
          airline = "Delta Airlines",
          trip7 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft],

          // DTW -> ATL (MAR 24)//
          time = 1*60 +44,
          numTrips = 1,
          dep = "DTW",
          arr = "ATL",
          aircraft = "757-200",
          airline = "Delta Airlines",
          trip8 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft],

          // DTW -> PLN //
          time = 1*60 +31,
          numTrips = 1,
          dep = "DTW",
          arr = "PLN",
          aircraft = "CRJ-200",
          airline = "Delta Airlines",
          trip9 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft];

          var trips = [trip1,trip2,trip3,trip4,trip5,trip6,trip7,trip8,trip9];

          // If no "new_trip", add nothing to trips array.
      if (typeof new_trip === 'undefined') {
          new_trip = "";
      }
          trips.push(new_trip);
          totalDist(trips);
    }



      function getDist() {
        var lat1 = parseFloat(document.getElementById("lat1").value),
            long1 = parseFloat(document.getElementById("long1").value),
            lat2 = parseFloat(document.getElementById("lat2").value),
            long2 = parseFloat(document.getElementById("long2").value),
            dist = distCalc(lat1,long1,lat2,long2);
            document.getElementById("demo").innerHTML = dist.toFixed(4) + " km.";
        //document.getElementById('demo').innerHTML = phi11
      }

      function totalDist() {
        //      Airports    //
              // ATL //
        var lat_ATL = 33.6407,
            long_ATL = -84.4277,

              // DTW //
            lat_DTW = 42.2162,
            long_DTW = -83.3554,

              // PLN //
            lat8 = 45.5715,
            long8 = -84.7862,

              // SEA //
            lat_SEA = 47.4502,
            long_SEA = -122.3088,

              // SLC //
            lat_SLC = 40.7899,
            long_SLC = -111.9791,

            airports = ["ATL","DTW","PLN","SEA","SLC"],
            aircrafts = ["737-900","757-200","A320","A321","CRJ-200","737-800"],
            airlines = ["Delta Airlines","Alaska Airlines","Spirit Airlines"],

            // LEGS //
            // ATL-> SLC //
            time = 4*60 +3,
            dep = "ATL",
            arr = "SLC",
            aircraft = "737-900",
            airline = "Delta Airlines",
            trip1 = [lat_ATL,long_ATL,lat_SLC,long_SLC,time,dep,arr,airline,aircraft],

            // SLC-> DTW //
            time = 3*60 +29,
            dep = "SLC",
            arr = "DTW",
            aircraft = "737-900",
            airline = "Delta Airlines",
            trip2 = [lat_SLC,long_SLC,lat_DTW,long_DTW,time,dep,arr,airline,aircraft],

            // DTW -> SEA //
            time = 4*60 +55,
            dep = "DTW",
            arr = "SEA",
            aircraft = "737-800",
            airline = "Alaska Airlines",
            trip3 = [lat_DTW,long_DTW,lat_SEA,long_SEA,time,dep,arr,airline,aircraft],

            // SEA -> DTW //
            time = 4*60 +55,
            dep = "SEA",
            arr = "DTW",
            aircraft = "A321",
            airline = "Spirit Airlines",
            trip4 = [lat_DTW,long_DTW,lat_SEA,long_SEA,time,dep,arr,airline,aircraft],

            // DTW -> ATL (JAN 6)//
            time = 2*60 +13,
            dep = "DTW",
            arr = "ATL",
            aircraft = "A320",
            airline = "Delta Airlines",
            trip5 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft],

            // ATL -> DTW (FEB 21)//
            time = 1*60 +37,
            dep = "ATL",
            arr = "DTW",
            aircraft = "737-900",
            airline = "Delta Airlines",
            trip6 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft],

            // DTW -> ATL (FEB 24)//
            time = 2*60 +13,
            dep = "DTW",
            arr = "ATL",
            aircraft = "A320",
            airline = "Delta Airlines",
            trip7 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft],

            // DTW -> ATL (MAR 24)//
            time = 1*60 +44,
            dep = "DTW",
            arr = "ATL",
            aircraft = "757-200",
            airline = "Delta Airlines",
            trip8 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft],

            // DTW -> PLN //
            time = 1*60 +31,
            dep = "DTW",
            arr = "PLN",
            aircraft = "CRJ-200",
            airline = "Delta Airlines",
            trip9 = [lat_DTW,long_DTW,lat_ATL,long_ATL,time,dep,arr,airline,aircraft];

        var trips = [trip1,trip2,trip3,trip4,trip5,trip6,trip7,trip8,trip9];



        var time = 0,
            i;
        for (i=0;i<trips.length;i++) {
            var time = time + trips[i][4];
        }
        var totalTime = minToHHMM(time);
        // var totalTime = time;

        // Find Total Distance and find the longest route flown.
        var dist = 0,
            longestTime = 0,
            shortestTime = 24*60,
            longDep,
            longArr,
            shortDep,
            shortArr,
            i;
        for(i=0;i<trips.length;i++) {
            var dist = dist + distCalc(trips[i][0],trips[i][1],trips[i][2],trips[i][3]);
            if (trips[i][4]>longestTime) {
              var longDep = trips[i][5],
                  longArr = trips[i][6],
                  longestTime = trips[i][4];
            }
            if (trips[i][4]<longestTime) {
              var shortDep = trips[i][5],
                  shortArr = trips[i][6],
                  shortestTime = trips[i][4];
            }
          }
          var longestTime = minToHHMM(longestTime),
             shortestTime = minToHHMM(shortestTime);


        // Determine Favorite Airport
        var i,
            j,
            faveAirport,
            numFlts = 0;
        for (i=0;i<airports.length;i++) {
          var counter = 0;
          for (j=0;j<trips.length;j++) {
            if (airports[i] == trips[j][5] || airports[i] == trips[j][6]) {
              counter++;
            }
          }
          if (counter > numFlts) {
            faveAirport = airports[i];
            numFlts = counter;
          }
        }
        // var faveAirportData = favorite(airports,trips,5,1),
        // faveAirport = faveAirportData[0],
        // numFlts = faveAirportData[1];

        // Determine Favorite aircraft
        var faveACFT,
            numOnACFT = 0;
        for (i=0;i<aircrafts.length;i++) {
          var counter = 0;
          for (j=0;j<trips.length;j++) {
            if (aircrafts[i] == trips[j][8]) {
              counter++;
            }
          }
          if (counter > numOnACFT) {
            faveACFT = aircrafts[i];
            numOnACFT = counter;
          }
        }

        // Determine Favorite Airline
        var faveAL,
            numOnAL = 0;
        for (i=0;i<airlines.length;i++) {
          var counter = 0;
          for (j=0;j<trips.length;j++) {
            if (airlines[i] == trips[j][7]) {
              counter++;
            }
          }
          if (counter > numOnAL) {
            faveAL = airlines[i];
            numOnAL = counter;
          }
        }


      document.getElementById("routeDist").innerHTML = dist.toFixed(0) + " km.";
      document.getElementById("moonDist").innerHTML = (dist/24901).toFixed(4);
      document.getElementById("demo2").innerHTML = totalTime;
      document.getElementById("longest").innerHTML = longDep + " -> " + longArr + " , "  + longestTime;
      document.getElementById("shortest").innerHTML = shortDep + " -> " + shortArr + " , "  + shortestTime;
      document.getElementById("faveAPT").innerHTML = faveAirport + ", " + numFlts + " flights";
      document.getElementById("faveAC").innerHTML = faveACFT + ", " + numOnACFT + " flights";
      document.getElementById("faveAirline").innerHTML = faveAL + ", " + numOnAL + " flights";
    }

      function miles() {
        var lat1 = parseFloat(document.getElementById("lat1").value),
            long1 = parseFloat(document.getElementById("long1").value),
            lat2 = parseFloat(document.getElementById("lat2").value),
            long2 = parseFloat(document.getElementById("long2").value),
            dist = distCalc(lat1,long1,lat2,long2)*0.62137119;
            document.getElementById("demo").innerHTML = dist.toFixed(4) + " miles";
      }

      // function favorite(items, tripList,index,bool) {
      //   var fave,
      //       numTimes = 0;
      //   for (i=0;i<items.length;i++) {
      //     var counter = 0;
      //     for (j=0;j<tripList.length;j++) {
      //       // If looking at airports, need to check arrival and departure airports //
      //       if (bool==1) {
      //         if (items[i] == tripList[j][index] || items[i] == tripList[j+1][index]) {
      //           counter++;
      //         }
      //       } else {
      //         if (items[i] == tripList[j][index]) {
      //           counter++;
      //         }
      //       }
      //     }
      //     if (counter > numTimes) {
      //       fave = items[i];
      //       numTimes = counter;
      //     }
      //   }
      //   return [fave,numTimes];
      // }

      // Convert time from units of minutes to HH:MM
      function minToHHMM(min) {
        if (min % 60 != 0) {
          var minutes = min %60,
                hours = (min/60 - (min%60/60)).toFixed(0);

        } else {
          var minutes = 0,
                hours = (min/60).toFixed(0);
        }

        if (hours==1 && minutes==1) {
          return hours + " hour " + minutes + " minute";
        } else if (hours==1 && minutes !=1) {
          return hours + " hour " + minutes + " minutes";
        } else {
          return hours + " hours " + minutes + " minutes";
        }
      }




      function distCalc(phi1, l1, phi2, l2) {
        var a = 6378137.0,
            f = 1/298.257223563,
            b = 6356752.314245,
            //phi1 = 33.636667,
            //l1 = -84.428056,
            //phi2 = -33.392778,
            //l2 = -70.785556,
            lamda = (l2-l1)*Math.PI/180,
            L = lamda,
            u1 = Math.atan((1-f)*Math.tan(phi1*Math.PI/180)),
            u2 = Math.atan((1-f)*Math.tan(phi2*Math.PI/180)),
            counter = 1;
      while (counter < 10**6){
        var sinS = Math.sqrt((Math.cos(u2)*Math.sin(lamda))**2 + (Math.cos(u1)*Math.sin(u2) - Math.sin(u1)*Math.cos(u2)*Math.cos(lamda))**2),
            cosS = Math.sin(u1)*Math.sin(u2) + Math.cos(u1)*Math.cos(u2)*Math.cos(lamda),
            sigma = Math.atan2(sinS,cosS),
            sinA = (Math.cos(u1)*Math.cos(u2)*Math.sin(lamda))/(Math.sin(sigma)),
            cosASQ = 1 - (sinA**2),
            cos2SM = Math.cos(sigma) - (2*Math.sin(u1)*Math.sin(u2)/cosASQ),
            C = (f/16)*cosASQ*(4 + f*(4-(3*cosASQ))),
            lamda = L + (1-C)*f*sinA*(sigma + C*sinS*(cos2SM+C*cosS*(-1+2*cos2SM**2)));
            if (counter != 1){
              if (lamda - lamdaStore <= 10**(-12)){
                break;
              }
            }
        var lamdaStore = lamda,
            counter = counter+1;
      }
        var uSQ = cosASQ*((a**2 - b**2)/b**2),
            A = 1 + (uSQ/16384)*(4096+uSQ*(-768+uSQ*(320-175*uSQ))),
            B = (uSQ/1024)*(256 + uSQ*(-128 + uSQ*(74-47*uSQ))),
            deltaSig = B*sinS*(cos2SM+0.25*B*(cosS*(-1+2*cos2SM**2))-(B/6)*cos2SM*(-3+4*cos2SM**2)),
            s = b*A*(sigma-deltaSig),
            alpha1 = Math.atan2(Math.cos(u2)*Math.sin(lamda), Math.cos(u1)*Math.sin(u2)-(Math.sin(u1)*Math.cos(u2)*Math.cos(lamda))),
            distance = s*10**(-3),
            newLong = l1;
            return distance;

            }


    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBUKuCWODok_ZqmM62Y67nQJkeO8hyIm6o&callback=initMap">
    </script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
   <div class="footer">
     <h5>Any Questions? Contact me using any of the methods below:</h5>
     <h5>Cell: (248)-224-6495</h5>
     <h5>Email: maxgeissbuhler1@gmail.com</h5>
     <a href="https://www.linkedin.com/in/maxgeissbuhler/"><i class='fab fa-linkedin' style='font-size:36px'></i></a>
     <a href="mailto:maxgeissbuhler1@gmail.com"><i class='fas fa-mail-bulk' style='font-size:36px; color:red;padding-left:5px'></i></a>
     <a href="https://www.facebook.com/max.geissbuhler"><i class='fab fa-facebook-square' style='font-size:36px;padding-left:5px'></i></a>
   </div>
  </body>
</html>
